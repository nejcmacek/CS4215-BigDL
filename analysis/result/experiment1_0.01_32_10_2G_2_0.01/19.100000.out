2019-10-15 23:09:48 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2019-10-15 23:09:49 INFO  SparkContext:54 - Running Spark version 2.3.1
2019-10-15 23:09:49 INFO  SparkContext:54 - Submitted application: lenet5
2019-10-15 23:09:49 INFO  SecurityManager:54 - Changing view acls to: martijn01_vermeulen
2019-10-15 23:09:49 INFO  SecurityManager:54 - Changing modify acls to: martijn01_vermeulen
2019-10-15 23:09:49 INFO  SecurityManager:54 - Changing view acls groups to: 
2019-10-15 23:09:49 INFO  SecurityManager:54 - Changing modify acls groups to: 
2019-10-15 23:09:49 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(martijn01_vermeulen); groups with view permissions: Set(); users  with modify permissions: Set(martijn01_vermeulen); groups with modify permissions: Set()
2019-10-15 23:09:49 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 46249.
2019-10-15 23:09:49 INFO  SparkEnv:54 - Registering MapOutputTracker
2019-10-15 23:09:49 INFO  SparkEnv:54 - Registering BlockManagerMaster
2019-10-15 23:09:49 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2019-10-15 23:09:49 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2019-10-15 23:09:49 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-af0c6694-d23e-47f5-97de-a64326087bbb
2019-10-15 23:09:49 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2019-10-15 23:09:49 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2019-10-15 23:09:49 INFO  log:192 - Logging initialized @3284ms
2019-10-15 23:09:50 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2019-10-15 23:09:50 INFO  Server:414 - Started @3404ms
2019-10-15 23:09:50 INFO  AbstractConnector:278 - Started ServerConnector@6b1524e{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2019-10-15 23:09:50 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1a2cb354{/jobs,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1c02f74f{/jobs/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@17e13975{/jobs/job,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@23fffed6{/jobs/job/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@284cdd69{/stages,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@36f87384{/stages/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@79d44e28{/stages/stage,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1e791a6c{/stages/stage/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4507b285{/stages/pool,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@689f49f9{/stages/pool/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@425b3a2c{/storage,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1427e271{/storage/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6c4cf9ea{/storage/rdd,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7e8ea51b{/storage/rdd/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@659f7abc{/environment,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4e003814{/environment/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@45881b97{/executors,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4e25c840{/executors/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@507111a2{/executors/threadDump,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1ffe4320{/executors/threadDump/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1aafb7eb{/static,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5eb42153{/,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@39c5f62d{/api,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@606170e2{/jobs/job/kill,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@396d885a{/stages/stage/kill,null,AVAILABLE,@Spark}
2019-10-15 23:09:50 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://project-group-85cf.europe-west4-a.c.quantitative-performance.internal:4040
2019-10-15 23:09:50 INFO  SparkContext:54 - Added JAR file:///home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar at spark://project-group-85cf.europe-west4-a.c.quantitative-performance.internal:46249/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar with timestamp 1571180990308
2019-10-15 23:09:50 INFO  SparkContext:54 - Added file file:/home/test/bd/codes/lenet5.py at spark://project-group-85cf.europe-west4-a.c.quantitative-performance.internal:46249/files/lenet5.py with timestamp 1571180990350
2019-10-15 23:09:50 INFO  Utils:54 - Copying /home/test/bd/codes/lenet5.py to /tmp/spark-fa78b08b-772b-4c7c-b6cd-9ba7a61aead1/userFiles-a7b8a289-610d-4fbb-9fbe-aaf41f2aefeb/lenet5.py
2019-10-15 23:09:50 INFO  SparkContext:54 - Added file file:///home/test/bd/spark/lib/bigdl-0.8.0-python-api.zip at spark://project-group-85cf.europe-west4-a.c.quantitative-performance.internal:46249/files/bigdl-0.8.0-python-api.zip with timestamp 1571180990366
2019-10-15 23:09:50 INFO  Utils:54 - Copying /home/test/bd/spark/lib/bigdl-0.8.0-python-api.zip to /tmp/spark-fa78b08b-772b-4c7c-b6cd-9ba7a61aead1/userFiles-a7b8a289-610d-4fbb-9fbe-aaf41f2aefeb/bigdl-0.8.0-python-api.zip
2019-10-15 23:09:50 INFO  StandaloneAppClient$ClientEndpoint:54 - Connecting to master spark://10.164.0.2:7077...
2019-10-15 23:09:50 INFO  TransportClientFactory:267 - Successfully created connection to /10.164.0.2:7077 after 82 ms (0 ms spent in bootstraps)
2019-10-15 23:09:50 INFO  StandaloneSchedulerBackend:54 - Connected to Spark cluster with app ID app-20191015230950-0370
2019-10-15 23:09:50 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor added: app-20191015230950-0370/0 on worker-20191014155229-10.164.0.3-45141 (10.164.0.3:45141) with 1 core(s)
2019-10-15 23:09:50 INFO  StandaloneSchedulerBackend:54 - Granted executor ID app-20191015230950-0370/0 on hostPort 10.164.0.3:45141 with 1 core(s), 2.0 GB RAM
2019-10-15 23:09:50 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 41625.
2019-10-15 23:09:50 INFO  NettyBlockTransferService:54 - Server created on project-group-85cf.europe-west4-a.c.quantitative-performance.internal:41625
2019-10-15 23:09:50 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2019-10-15 23:09:50 INFO  StandaloneAppClient$ClientEndpoint:54 - Executor updated: app-20191015230950-0370/0 is now RUNNING
2019-10-15 23:09:50 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, project-group-85cf.europe-west4-a.c.quantitative-performance.internal, 41625, None)
2019-10-15 23:09:50 INFO  BlockManagerMasterEndpoint:54 - Registering block manager project-group-85cf.europe-west4-a.c.quantitative-performance.internal:41625 with 366.3 MB RAM, BlockManagerId(driver, project-group-85cf.europe-west4-a.c.quantitative-performance.internal, 41625, None)
2019-10-15 23:09:50 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, project-group-85cf.europe-west4-a.c.quantitative-performance.internal, 41625, None)
2019-10-15 23:09:50 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, project-group-85cf.europe-west4-a.c.quantitative-performance.internal, 41625, None)
2019-10-15 23:09:51 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@21fae11c{/metrics/json,null,AVAILABLE,@Spark}
2019-10-15 23:09:53 INFO  CoarseGrainedSchedulerBackend$DriverEndpoint:54 - Registered executor NettyRpcEndpointRef(spark-client://Executor) (10.164.0.3:59600) with ID 0
2019-10-15 23:09:53 INFO  StandaloneSchedulerBackend:54 - SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 1.0
2019-10-15 23:09:53 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 10.164.0.3:45361 with 1007.8 MB RAM, BlockManagerId(0, 10.164.0.3, 45361, None)
2019-10-15 23:09:54 INFO  Engine$:112 - Auto detect executor number and executor cores number
2019-10-15 23:09:54 INFO  Engine$:114 - Executor number is 1 and executor cores number is 1
2019-10-15 23:09:54 INFO  ThreadPool$:95 - Set mkl threads to 1 on thread 18
2019-10-15 23:09:54 INFO  Engine$:402 - Find existing spark context. Checking the spark conf...
cls.getname: com.intel.analytics.bigdl.python.api.Sample
BigDLBasePickler registering: bigdl.util.common  Sample
cls.getname: com.intel.analytics.bigdl.python.api.EvaluatedResult
BigDLBasePickler registering: bigdl.util.common  EvaluatedResult
cls.getname: com.intel.analytics.bigdl.python.api.JTensor
BigDLBasePickler registering: bigdl.util.common  JTensor
cls.getname: com.intel.analytics.bigdl.python.api.JActivity
BigDLBasePickler registering: bigdl.util.common  JActivity
0.01
('Extracting', '/tmp/mnist/train-images-idx3-ubyte.gz')
('Extracting', '/tmp/mnist/train-labels-idx1-ubyte.gz')
('Extracting', '/tmp/mnist/t10k-images-idx3-ubyte.gz')
('Extracting', '/tmp/mnist/t10k-labels-idx1-ubyte.gz')
creating: createSequential
creating: createReshape
creating: createSpatialConvolution
creating: createTanh
creating: createSpatialMaxPooling
creating: createSpatialConvolution
creating: createTanh
creating: createSpatialMaxPooling
creating: createReshape
creating: createLinear
creating: createTanh
creating: createLinear
creating: createLogSoftMax
creating: createClassNLLCriterion
creating: createDefault
creating: createSGD
creating: createMaxEpoch
creating: createDistriOptimizer
disableCheckSingleton is deprecated. Please use bigdl.check.singleton instead
creating: createEveryEpoch
creating: createTop1Accuracy
creating: createEveryEpoch
2019-10-15 23:09:56 INFO  DistriOptimizer$:784 - caching training rdd ...
2019-10-15 23:09:59 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59604; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:01 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59606; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:03 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59608; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:05 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59610; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:09 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59616; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:11 ERROR TransportRequestHandler:226 - Error sending result StreamResponse{streamId=/jars/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, byteCount=124014227, body=FileSegmentManagedBuffer{file=/home/test/bd/spark/lib/bigdl-SPARK_2.3-0.8.0-jar-with-dependencies.jar, offset=0, length=124014227}} to /10.164.0.3:59618; closing connection
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileChannelImpl.transferTo0(Native Method)
	at sun.nio.ch.FileChannelImpl.transferToDirectlyInternal(FileChannelImpl.java:428)
	at sun.nio.ch.FileChannelImpl.transferToDirectly(FileChannelImpl.java:493)
	at sun.nio.ch.FileChannelImpl.transferTo(FileChannelImpl.java:605)
	at io.netty.channel.DefaultFileRegion.transferTo(DefaultFileRegion.java:145)
	at org.apache.spark.network.protocol.MessageWithHeader.transferTo(MessageWithHeader.java:121)
	at io.netty.channel.socket.nio.NioSocketChannel.doWriteFileRegion(NioSocketChannel.java:355)
	at io.netty.channel.nio.AbstractNioByteChannel.doWrite(AbstractNioByteChannel.java:224)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:382)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:934)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:368)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:639)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
2019-10-15 23:10:11 ERROR TaskSetManager:70 - Task 0 in stage 0.0 failed 4 times; aborting job
Traceback (most recent call last):
  File "/home/test/bd/codes/lenet5.py", line 73, in <module>
    trained_model = optimizer.optimize()
  File "/home/test/bd/spark/lib/bigdl-0.8.0-python-api.zip/bigdl/optim/optimizer.py", line 764, in optimize
  File "/home/test/bd/spark/lib/bigdl-0.8.0-python-api.zip/bigdl/util/common.py", line 634, in callJavaFunc
  File "/home/test/bd/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1257, in __call__
  File "/home/test/bd/spark/python/lib/py4j-0.10.7-src.zip/py4j/protocol.py", line 328, in get_return_value
py4j.protocol.Py4JJavaError: An error occurred while calling o108.optimize.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 0.0 failed 4 times, most recent failure: Lost task 0.3 in stage 0.0 (TID 6, 10.164.0.3, executor 0): java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply$mcJ$sp(Utils.scala:350)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply(Utils.scala:335)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply(Utils.scala:335)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1380)
	at org.apache.spark.util.Utils$.copyStream(Utils.scala:356)
	at org.apache.spark.util.Utils$.downloadFile(Utils.scala:536)
	at org.apache.spark.util.Utils$.doFetchFile(Utils.scala:666)
	at org.apache.spark.util.Utils$.fetchFile(Utils.scala:475)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:755)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:747)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at org.apache.spark.executor.Executor.org$apache$spark$executor$Executor$$updateDependencies(Executor.scala:747)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:312)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1602)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1590)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1589)
	at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1589)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1823)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1772)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1761)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)
	at org.apache.spark.rdd.RDD.count(RDD.scala:1162)
	at com.intel.analytics.bigdl.dataset.DistributedDataSet$$anon$5.cache(DataSet.scala:191)
	at com.intel.analytics.bigdl.optim.AbstractOptimizer.prepareInput(AbstractOptimizer.scala:282)
	at com.intel.analytics.bigdl.optim.DistriOptimizer.prepareInput(DistriOptimizer.scala:785)
	at com.intel.analytics.bigdl.optim.DistriOptimizer.optimize(DistriOptimizer.scala:841)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: No space left on device
	at java.io.FileOutputStream.writeBytes(Native Method)
	at java.io.FileOutputStream.write(FileOutputStream.java:326)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply$mcJ$sp(Utils.scala:350)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply(Utils.scala:335)
	at org.apache.spark.util.Utils$$anonfun$copyStream$1.apply(Utils.scala:335)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1380)
	at org.apache.spark.util.Utils$.copyStream(Utils.scala:356)
	at org.apache.spark.util.Utils$.downloadFile(Utils.scala:536)
	at org.apache.spark.util.Utils$.doFetchFile(Utils.scala:666)
	at org.apache.spark.util.Utils$.fetchFile(Utils.scala:475)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:755)
	at org.apache.spark.executor.Executor$$anonfun$org$apache$spark$executor$Executor$$updateDependencies$5.apply(Executor.scala:747)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:733)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:732)
	at org.apache.spark.executor.Executor.org$apache$spark$executor$Executor$$updateDependencies(Executor.scala:747)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:312)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	... 1 more

